// Nice try :P
var graphics=document.getElementById("graphics");function registerDrawCommand(e,r,t){document.getElementById(e).addEventListener("click",function(){handle_drawing(r,t,[],[])})}function handle_drawing(e,r,t,n){0==e.length?(delete_markers(n),draw_batch(r.apply(this,t))):(curr_message=e[0],e=e.slice(1),input_point(curr_message,function(a){t.push(a),n.push(add_marker(a.x,a.y)),handle_drawing(e,r,t,n)}))}function generateCircle(e,r){for(var t=[],n=Math.sqrt(Math.pow(e.x-r.x,2)+Math.pow(e.y-r.y,2)),a=0;a<=n;a+=n/50)for(var i=0;i<a/3;i++)angle=2*Math.random()*Math.PI,curr_r=2*Math.random()-1+a,x=e.x+curr_r*Math.cos(angle),y=e.y+curr_r*Math.sin(angle),t.push({x:x,y:y});return t}function generateLine(e,r){for(var t=[],n=0;n<=1;n+=.02)for(var a=0;a<7;a++)t.push({x:n*r.x+(1-n)*e.x+10*(Math.random()-.5),y:n*r.y+(1-n)*e.y+10*(Math.random()-.5)});return t}function generateSpiral(e,r){for(var t=[],n=e.x,a=e.y,i=Math.sqrt(Math.pow(n-r.x,2)+Math.pow(a-r.y,2)),c=Math.atan2(r.y-e.y,r.x-e.x),o=0;o<=i;o+=i/100)for(var l=0;l<10;l++)curr_r=2*Math.random()-1+o,angle=c+2*Math.PI*curr_r/i,x=n+curr_r*Math.cos(angle)+10*(Math.random()-.5),y=a+curr_r*Math.sin(angle)+10*(Math.random()-.5),t.push({x:x,y:y});return t}function generateTriangle(e,r,t){var n=generateLine(e,r);return n=(n=n.concat(generateLine(r,t))).concat(generateLine(t,e))}function draw_batch(e){for(var r=0;r<Math.ceil(e.length/1);r++)!function(r){setTimeout(function(){for(var t=1*r;t<Math.min(1*r+1,e.length);t++)add_point(e[t].x,e[t].y)},r/3)}(r)}function add_point(e,r){var t=document.createElementNS("http://www.w3.org/2000/svg","circle");return t.setAttribute("cx",e),t.setAttribute("cy",r),t.setAttribute("r",4),t.setAttribute("fill",get_current_color()),graphics.appendChild(t),t}function add_marker(e,r){return marker=add_point(e,r),marker.setAttribute("r",10),marker.setAttribute("fill","#FFFFFF"),marker}function delete_markers(e){for(var r=e.length-1;r>=0;r--)e[r].parentNode.removeChild(e[r])}function input_point(e,r){document.getElementById("overlay-text").innerHTML=e;var t=document.getElementsByClassName("overlay")[0];t.addEventListener("click",function(e){t.style.display="";var n=t.cloneNode(!0);t.parentNode.replaceChild(n,t),r({x:e.clientX,y:e.clientY})}),t.style.display="block"}function get_current_color(){return document.getElementsByTagName("input")[0].value}document.getElementById("chooseColor").addEventListener("click",function(){document.getElementsByTagName("input")[0].click()}),document.getElementById("clear").addEventListener("click",function(){circles=document.getElementsByTagName("circle");for(var e=circles.length-1;e>=0;e--)circles[e].parentNode.removeChild(circles[e])}),registerDrawCommand("drawCircle",["Pick circle center","Pick point on circle circumference"],generateCircle),registerDrawCommand("drawLine",["Pick start of line","Pick end of line"],generateLine),registerDrawCommand("drawSpiral",["Pick spiral center","Pick spiral end"],generateSpiral),registerDrawCommand("drawTriangle",["Pick point A","Pick point B","Pick point C"],generateTriangle);
